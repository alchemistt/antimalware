import os
import array
import numpy as np
import tensorflow as tf
import imageio
import tkinter as tk
from tkinter import ttk
from tkinter import *
from tkinter import messagebox
import tkinter.filedialog
from tkinter import filedialog
from PIL import ImageTk, Image
from tkinter import messagebox
import shutil
import cv2
# 
root = Tk()

#root.geometry("800x490")
#title_bar = Frame(root, bg='white',relief='raised', bd=2)
#root.overrideredirect(True)
root.geometry("800x490")
root.title('Malware Detector')
#root.resizable(width=False, height=False)
#close_button = Button(title_bar, text='X', command=root.destroy)
#title_bar.pack(expand=1, fill=X)
#close_button.pack(side=RIGHT)
left = Frame(root, borderwidth=1, relief="solid")
right = Frame(root, borderwidth=1, relief="solid")
container = Frame(left, borderwidth=1, relief="solid")
box1 = Frame(right, borderwidth=1, relief="solid")
box2 = Frame(right, borderwidth=1, relief="solid")
left = Frame(root, borderwidth=1, relief="solid")
right = Frame(root, borderwidth=1, relief="solid")
container = Frame(left, borderwidth=1, relief="solid")
box1 = Frame(right, borderwidth=1, relief="solid")
box2 = Frame(right, borderwidth=1, relief="solid")
container.configure(bg='#2a7fba',width=200, height=600)
box1.configure(width=150, height=200)
box2.configure(width=400, height=1200)
left.pack(side="left", expand=True, fill="both")
right.pack(side="right", expand=True, fill="both")
container.pack(expand=True, fill="both", padx=5, pady=5)
box1.pack(expand=True, fill="both", padx=10, pady=10)
box2.pack(expand=True, fill="both", padx=10, pady=10)
my_img1 = ImageTk.PhotoImage(Image.open("download.jpg"))
my_label1 = Label(container,image=my_img1).grid(row = 0, column = 2, 
        columnspan = 2, rowspan = 2, padx = 5, pady = 5)


#label2 = Label(container, text="Protect Your PC",bg='darkslategray',fg='white')
#label2.place(relx=0.5, rely=0.5,anchor=SW)

root.iconbitmap(r'logo.ico')
my_img = PhotoImage(file="Malware-icon.png")

my_label = Label(box1,image=my_img).grid(row = 0, column = 0, 
        columnspan = 2, rowspan = 2, padx = 5, pady = 5)

photo = PhotoImage(file=r"Malware-icon.png")
photoimage = photo.subsample(3,3) 

  
 


def callback():
    path = tkinter.filedialog.askopenfilename()
   
    filepath=path
    f=open(filepath,'rb')
    ln=os.path.getsize(filepath) 
    width=256
    rem=ln%width
    a=array.array("B")
    b=a.fromfile(f,ln-rem)
    f.close()
    g=np.reshape(a,(len(a)//width,width))
    g=np.uint8(g)
    imageio.imwrite(r'C:\Users\Mayank\Desktop\antimalware\alchemist\New folder\mal.png',g)
    tk.messagebox.showinfo('completed')
    mal("mal.png")
    
def browse_button():
    path = tkinter.filedialog.askdirectory() 
    file_name=path
    f=open(file_name,'rb')
    ln=os.path.getsize(file_name)
    width=256
    rem=ln%width
    a=array.array("B")
    b=a.fromfile(f,ln-rem)
    f.close()
    g=np.reshape(a,(len(a)//width,width))
    g=np.uint8(g)
    imageio.imwrite(r'C:\Users\Shraddha\Desktop\ml\temp8.png',g)
   

import cv2
import tensorflow as tf
import numpy as np
import os

def prepare(filepath):
    IMG_SIZE = 64
    img_array = cv2.imread((filepath), cv2.IMREAD_GRAYSCALE)
    new_array = cv2.resize(img_array, (IMG_SIZE, IMG_SIZE))
    new_array = np.array(new_array, dtype='float32')
    return new_array.reshape(-1, IMG_SIZE, IMG_SIZE, 1)


def mal(filename):
    CATEGORIES = ["Benign", "Malware"]
    model = tf.keras.models.load_model("train(93.27).model")
    prediction = model.predict([prepare(filename)])
    print(CATEGORIES[int(prediction[0][0])])
    return (CATEGORIES[int(prediction[0][0])])

    


# prediction = model.predict([prepare('000b2eb0324e774229705f6318ecefef.png')])
# print(prediction)

def Scan_for_virus():
    
    toplevel = Toplevel()
    toplevel.title('Scanning window')
    toplevel.geometry('900x490')
    toplevel.focus_set()
    toplevel.configure(bg='gainsboro')
    toplevel.resizable(width=False, height=False)

    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    containers.configure(bg='steel blue',width=200, height=600)
    box3.configure(bg='white',width=200, height=200)
    box4.configure(bg='white',width=400, height=1200)
    left.pack(side="left", expand=True, fill="both")
    right.pack(side="right", expand=True, fill="both")
    containers.pack(expand=True, fill="both", padx=5, pady=5)
    box3.pack(expand=True, fill="both", padx=10, pady=10)
    box4.pack(expand=True, fill="both", padx=10, pady=10)
    toplevel.iconPath = 'download.jpg'
    toplevel.icon = ImageTk.PhotoImage(Image.open(toplevel.iconPath))
   # my_label2 = Label(containers,image=my_img8).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    toplevel.icon_size = Label(box3, image = toplevel.icon)
    toplevel.icon_size.pack(side=TOP)
   # toplevel.icon_size.grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
   # my_img2 = ImageTk.PhotoImage(Image.open("download.png"))
   # my_label2 = Label(container,image=my_img2).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    #photo = ImageTk.PhotoImage(Image.open("images (1).gif"))
    #label = Label(box3,image = photo).grid()



    btn=Button(box4,text='Scan File',fg='black',font='bold',command=callback,height=2, width=10).pack(side=LEFT,pady=20,padx=20)
   
   # btn1=Button(box4,text='Scan Folder',fg='black',font='bold',command=browse_button,height=2,width=10).pack(side=LEFT,pady=30,padx=30)
    
    lbl=Label(box3,text='Scan Your PC',bg='white',fg='black',font='bold').pack()
    lbl2=Label(box3,text='Run a quick,custom,full scan to wipe out viruses',bg='white',fg='black',font='bold').pack()
    lbl3=Label(box3,text='or let Real-Time Scanning instantly check any files any time',bg='white',fg='black',font='bold').pack()
    lbl5=Label(box3,text='Run a quick scan',bg='white',fg='black',font='bold').pack()
    lbl6=Label(box3,text='Run a full scan',bg='white',fg='black',font='bold').pack()



  

photoo=PhotoImage(file="Malware-icon.png")
b = Button(box2,text="Virus Scan",fg='Black',font='bold',command=Scan_for_virus,height=2,width=10).pack(side=LEFT,pady=10,padx=5)
#b.place(relx=0.1, rely=0.4, anchor= CENTER)
#btn1=Button(toplevel,text='Scan Folder',command=browse_button,height=5,width=15).pack()
def scan():
    toplevel = Toplevel()
    toplevel.title('Scanning window')
    toplevel.geometry('800x490')
    toplevel.focus_set()
    toplevel.configure(bg='darkslategray')
    toplevel.resizable(width=False, height=False)
    toplevel.resizable(width=False, height=False)

    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    containers.configure(bg='steel blue',width=200, height=600)
    box3.configure(width=200, height=200)
    box4.configure(width=400, height=1200)
    left.pack(side="left", expand=True, fill="both")
    right.pack(side="right", expand=True, fill="both")
    containers.pack(expand=True, fill="both", padx=5, pady=5)
    box3.pack(expand=True, fill="both", padx=10, pady=10)
    box4.pack(expand=True, fill="both", padx=10, pady=10)
    my_img3 = ImageTk.PhotoImage(Image.open(r"C:\Users\Shraddha\Desktop\image\security.jpg"))
    my_label2 = Label(containers,image=my_img3).pack(side=TOP)
    my_img1 = ImageTk.PhotoImage(Image.open(r"C:\Users\Shraddha\Desktop\image\clearry.jpg"))
    my_label2 = Label(box3,image=my_img1).pack(side=TOP)
    def ok():
        os.remove(r'C:\Users\Shraddha\Desktop\ml\book89.png')
        tk.messagebox.showinfo('Deleted')
    


    btn=Button(box4,text='Back',bg='orange',fg='black',font='bold',height=2, width=8,command=Scan_for_virus).grid(row=80,column=100)
    def allow():
        tk.messagebox.showinfo('Allowded')
    def freeze():
        tk.messagebox.showinfo('Freezed Keep Going')
    btn=Button(box4,text='Allow',bg='orange',fg='black',font='bold',command=allow,height=2, width=8).grid(row=80,column=200)
    btn=Button(box4,text='Delete',bg='orange',fg='black',font='bold',command=ok,height=2, width=8).grid(row=80,column=300)
    btn=Button(box4,text='Freeze',bg='orange',fg='black',font='bold',command=freeze,height=2, width=8).grid(row=80,column=400)
    btn=Button(box4,text='Help',bg='orange',fg='black',font='bold',height=2, width=8,command=info).grid(row=80,column=500)
    lbl=Label(box3,text='Get rids of files that track you online',fg='black',font='bold').pack()
    lbl=Label(box3,text='Protect your privacy by quickly deleting the cookies ',fg='black',font='bold').pack()
    lbl=Label(box3,text='trackers you have picked up online',fg='black',font='bold').pack()
    
    toplevel.mainloop()

b1 = Button(box2,text="Clean Up",fg='black',font='bold',compound=LEFT,command=scan,height=2,width=10).pack(side=LEFT,pady=20,padx=5)

v = StringVar()
photos = PhotoImage(file=r"Malware-icon.png")
photoimages = photo.subsample(3,3)
def speedup():
    toplevel = Toplevel()
    toplevel.title('SpeedUp')
    toplevel.geometry('800x490')
    toplevel.focus_set()
    toplevel.configure(bg='gray10')
    toplevel.resizable(width=False, height=False)

    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    left = Frame(toplevel, borderwidth=1, relief="solid")
    right = Frame(toplevel, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    containers.configure(bg='steelblue',width=60, height=600)
    box3.configure(bg='white',width=200, height=200)
    box4.configure(bg='white',width=400, height=1200)
    left.pack(side="left", expand=True, fill="both")
    right.pack(side="right", expand=True, fill="both")
    containers.pack(expand=True, fill="both", padx=5, pady=5)
    box3.pack(expand=True, fill="both", padx=10, pady=10)
    box4.pack(expand=True, fill="both", padx=10, pady=10)
    toplevel.iconPath = 'booster.jpg'
    toplevel.icon = ImageTk.PhotoImage(Image.open(toplevel.iconPath))
   # my_label2 = Label(containers,image=my_img8).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    toplevel.icon_size = Label(containers, image = toplevel.icon)
    #toplevel.icon_size.pack(side=LEFT,anchor=W)
    toplevel.icon_size.grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 35, pady = 10)
    my_img2 = ImageTk.PhotoImage(Image.open("boosto.jpg"))
    my_label2 = Label(container,image=my_img2).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    def clean():
        toplevel = Toplevel()
        toplevel.title('SpeedUp')
        toplevel.geometry('800x490')
        toplevel.focus_set()
        toplevel.configure(bg='black')
        toplevel.resizable(width=False, height=False)

        left = Frame(toplevel, borderwidth=1, relief="solid")
        right = Frame(toplevel, borderwidth=1, relief="solid")
        containers = Frame(left, borderwidth=1, relief="solid")
        box3 = Frame(right, borderwidth=1, relief="solid")
        box4 = Frame(right, borderwidth=1, relief="solid")
        left = Frame(toplevel, borderwidth=1, relief="solid")
        right = Frame(toplevel, borderwidth=1, relief="solid")
        containers = Frame(left, borderwidth=1, relief="solid")
        box3 = Frame(right, borderwidth=1, relief="solid")
        box4 = Frame(right, borderwidth=1, relief="solid")
        containers.configure(bg='gray10',width=60, height=600)
        box3.configure(width=200, height=200)
        box4.configure(width=400, height=1200)
        left.pack(side="left", expand=True, fill="both")
        right.pack(side="right", expand=True, fill="both")
        containers.pack(expand=True, fill="both", padx=5, pady=5)
        box3.pack(expand=True, fill="both", padx=10, pady=10)
        box4.pack(expand=True, fill="both", padx=10, pady=10)
        lbl=Label(containers,text='Web Boost stop annoying auto playing videos',bg='black',fg='white',font='bold').pack()
        lbl=Label(containers,text='So that they do not interuptt your web browsing',bg='black',fg='white',font='bold').pack()
        lbl=Label(containers,text='or drain your data and battery life',bg='black',fg='white',font='bold').pack()
        lbl=Label(box4,text='Nothing to report yet',bg='white',fg='black',font='bold').pack()
        lbl=Label(box4,text='Check back to see how many videos we stopped form auto-',bg='white',fg='black',font='bold').pack()
        lbl=Label(box4,text='playing after you have browsed the web',bg='white',fg='black',font='bold').pack()


                           
    button2 = Button(box3,text="Speedup Browsing",fg='black',font='bold',compound=LEFT,command=clean,height=5, width=40).pack(side=LEFT,pady=20,padx=20)

    button5 = Button(box4,text="Speedup APP",fg='black',compound=LEFT,height=5, width=20).pack(side=LEFT,pady=20,padx=20)
    button3= Button(box4,text="Back",fg='black',compound=LEFT,height=5, width=20,command=Scan_for_virus).pack(side=LEFT,pady=20,padx=20)


b2 = Button(box2,text="Speedup",fg='black',font='bold',compound=LEFT,command=speedup,height=2, width=10).pack(side=LEFT,pady=30,padx=5)
def info():
    toplevel1 = Toplevel()
    toplevel1.title('My Info')
    toplevel1.geometry('800x490')
    toplevel1.focus_set()
    toplevel1.configure(bg='white')
    toplevel1.resizable(width=False, height=False)

    left = Frame(toplevel1, borderwidth=1, relief="solid")
    right = Frame(toplevel1, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=2, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    left = Frame(toplevel1, borderwidth=1, relief="solid")
    right = Frame(toplevel1, borderwidth=1, relief="solid")
    containers = Frame(left, borderwidth=1, relief="solid")
    box3 = Frame(right, borderwidth=1, relief="solid")
    box4 = Frame(right, borderwidth=1, relief="solid")
    containers.configure(bg='white',width=200, height=600)
    box3.configure(bg='white',width=200, height=200)
    box4.configure(bg='white',width=400, height=1200)
    left.pack(side="left", expand=True, fill="both")
    right.pack(side="right", expand=True, fill="both")
    containers.pack(expand=True, fill="both", padx=5, pady=5)
    box3.pack(expand=True, fill="both", padx=10, pady=10)
    box4.pack(expand=True, fill="both", padx=10, pady=10)
    toplevel1.iconPath = 'download.jpg'
    toplevel1.icon = ImageTk.PhotoImage(Image.open(toplevel1.iconPath))
   # my_label2 = Label(containers,image=my_img8).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    toplevel1.icon_size = Label(containers, image = toplevel1.icon)
    #toplevel1.icon_size.pack(side=LEFT)
    toplevel1.icon_size.grid(row = 2, column = 2,columnspan = 2, rowspan = 2, padx = 30, pady = 10)
   # button2 = Button(box2,text="Speedup",fg='black',compound=LEFT,command=speedup,height=20, width=60).pack(side=LEFT,pady=20,padx=20)
    lbl=Label(box3,text='We are Here For You',fg='black',bg='white',font='bold').pack(anchor=CENTER)
    lbl1=Label(box3,text='Check out our support site,chat online,or call us--whatever works best for you',bg='white',fg='black',font='bold').pack()
    btn=Button(box3,text='Contact Us',fg='white',bg='midnightblue',font='bold').pack()

    toplevel1.iconPath1 = 'Malware-icon.png'
    toplevel1.icon1 = ImageTk.PhotoImage(Image.open(toplevel1.iconPath1))
   # my_label2 = Label(containers,image=my_img8).grid(row = 0, column = 2,columnspan = 2, rowspan = 2, padx = 5, pady = 5)
    toplevel1.icon1_size = Label(box4, image = toplevel1.icon1)
    #toplevel1.icon_size.pack(side=LEFT)
    toplevel1.icon1_size.grid(row = 3, column = 2,columnspan = 2, rowspan = 2, padx = 30, pady = 10)

photo = PhotoImage(file=r"Malware-icon.png")
photoimage = photo.subsample(3,3)
b=Button(box2,justify = LEFT)
#photo=PhotoImage(file="info.png")
b.config(text='INFO',command=info,fg='black',font='bold',width="10",height="2")
b.pack(side=LEFT,padx=5)



root.mainloop()
